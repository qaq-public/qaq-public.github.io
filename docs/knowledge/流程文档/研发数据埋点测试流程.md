import { WeChatLink, DocImage } from "/src/components/index.js"

## 研发数据埋点测试流程图

<DocImage src='pinottest/7811b0a6f6afbbd2cbcf726222339718.png'></DocImage>

## 运营与研发埋点需求

需求由运营发起给到研发项目接入

1.  确定必要的埋点事件

2.  确定客户端埋点事件与服务器埋点事件

3.  字段名规范统一

4.  确定必要的字段名信息

5.  需求文档内对字段内容的定义要一致，不可出现前后对同一字段定义不一致的情况

## 埋点需求文档模板

[埋点需求文档样本](https://qaq.com/static/G1/GTC%2F%E7%A0%94%E5%8F%91%E5%9F%8B%E7%82%B9/%E6%96%AF%E9%9C%B2%E5%BE%B7%E5%9F%8B%E7%82%B9%E6%96%87%E6%A1%A3.docx?download=true)

## 研发接入要求

1.  实现埋点需求时不可以出现由于埋点需求导致主逻辑报错卡死的情况

2.  明确需求，必须上报的字段名一定要上报

3.  上报格式：json字符串

4.  实现要与需求对齐

## 测试准备

项目组QA需要根据该文档的用例要求编写测试用例

### 测试用例要求

1.触发条件：明确在游戏内的操作步骤

2.事件名称：一般为埋点信息内的b_eventname字段内容，明确事件的名称，需求、用例、

制作三方都需要确认一致，预防出现事件名在数据表内查不到的情况

3.触发条件：触发埋点时的事件

4.测试用例：填写明确游戏内的操作步骤，确保行为能触发埋点

5.触发时间（分钟）：精确到分钟，时间为触发埋点事件的时间

6.b_log_id：记录这条埋点log的id（如图一所示），一般为b_log字段内容，用例里必须要有记录

图一
<DocImage src='pinottest/f6738561bf3c1f597bfe6647004daea1.png'></DocImage>

7.数据明细（odps）：整条埋点的log信息（如图二），通常情况下为massage字段内的内容，根据各个数据表制定

图二
<DocImage src='pinottest/3ad21aadc4ec5eff3279d223a568574c.png'></DocImage>

1.  测试结果：通过/不通过，不通过需写明备注与反馈

2.  备注1：记录公共字段的问题

3.  备注2：记录事件字段问题

4.  备注3：记录特殊问题

5.  研发反馈：项目组QA记录埋点问题

6.  数分备注：数据部记录埋点问题

### 测试用例模板

[埋点用例模板](https://qaq.com/static/G1/GTC%2F%E7%A0%94%E5%8F%91%E5%9F%8B%E7%82%B9/%E5%9F%8B%E7%82%B9%E6%B5%8B%E8%AF%95%E6%A8%A1%E6%9D%BF.xlsx)

[样本用例](https://qaq.com/static/G1/GTC%2F%E7%A0%94%E5%8F%91%E5%9F%8B%E7%82%B9/%E4%BB%A3%E5%8F%B7-C%E5%9F%8B%E7%82%B9%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B.xlsx)

### 申请查询权限

中台QA支持

1.  游戏项目平台地区：本地与海外的埋点数据表存放会有区别

2.  表内容：需要申请埋点数据源表

## 测试过程

项目组QA需要根据测试要求完成测试工作

### 测试要求

1.  埋点测试环境需要确认清楚（可以通过埋点信息内的"env"字段或者数据表判断是测试服还是线上服）

2.  测试的服务器是否正确（可以通过埋点信息内的"b_zone_id"字段判断自己所在服务器）

3.  确定游戏版本号是否正确（可以通过埋点信息内的"b_version"字段查看游戏版本）

4.  埋点时间触发时间要与数据表内时间对齐（可以通过埋点信息内的"b_datetime"字段查看事件触发时间，判断埋点的触发时间是否与需求一致）

5.  触发事件与数据表内事件的一致（可以通过埋点信息内的"b_eventname"字段）

6.  数据表内的每个埋点字段参数都要完整且合理

7.  埋点信息必有的字段：埋点log信息（b_log_id）、埋点事件名称（b_eventname）、埋点时间（b_datetime）、游戏id（b_game_id）、
    服务器id（b_zone_id）、埋点内容（properties{}）、游戏base_id（b_game_base_id）、频道id（b_channel_id）

8.  必要的事件字段不能出现结果为空或者为“？”的情况，个别特殊字段需判断是否不能为0的情况

9.  各个项目根据自身的埋点需求判断参数值是否正确，需求的埋点字段名是否存在，字段名称是否与需求一致，字段的数据类型是否与需求一致

10. 服务器埋点与客户端埋点的区分

11. 埋点信息内的字段数要与需求一致，必要字段必须要存在

12. 一条操作用例对应一个埋点

13. 明确必有的埋点事件：

服务端埋点事件：玩家登入登出游戏、玩家注册创角、实时在线、货币及道具变化、商店流水、关卡战斗、充值、玩家信息变更、任务、邮件流水、抽卡、SDK登录、玩家信息快照

客户端埋点事件：热更、游戏资源加载、游戏剧情、玩家改名和更改性别

### 数据查询

*注意：从触发事件到落库最多不超过1小时时间，海外游戏大概30分钟*

1.  明确需要查询的库表名与查询字段名

2.  中台根据不同项目组的数据表设计sql语句提供给项目QA支持测试

3.  现有的项目数据表及表的sql查询语句：

[项目埋点数据表](https://qaq.com/static/G1/GTC%2F%E7%A0%94%E5%8F%91%E5%9F%8B%E7%82%B9/%E9%A1%B9%E7%9B%AE%E5%9F%8B%E7%82%B9%E6%95%B0%E6%8D%AE%E8%A1%A8.xlsx)

1.  目前项目组内的数据表大致分为：

（1）event数据表：主要存放玩家埋点事件数据，大部分的埋点信息都在这

（2）snapshot数据表：存放玩家的信息快照表

（3）stage_bds_rd_src_i_hr数据表：存放项目client埋点数据

## 测试结果

### 项目QA

项目组QA输出测试结果给中台QA，项目QA跟进问题反馈修复，验证问题

### 中台QA

1.  中台QA根据项目需求文档审核项目组埋点用例

2.  验收项目组QA的测试用例结果，查看用例结果是否与需求对齐，结果符合测试要求

3.  中台验收需要着重检查道具和货币产销类的埋点用例，抽样验证用例结果

4.  将问题反馈给项目组QA，跟进项目组修复问题

5.  项目组修复已知问题并且给到中台QA最终测试用例结果，中台QA整理最终结果

6.  中台QA将用例结果反馈至数据部QA，并告知数据部QA已知问题

7.  数据部QA验证完毕后，将结果反馈至中台QA，中台QA将问题整理后反馈至项目组

8.  项目组根据优先级判断修复问题
