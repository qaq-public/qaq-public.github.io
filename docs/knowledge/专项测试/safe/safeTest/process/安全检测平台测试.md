---
sidebar_position: 3
---

import { WeChatLink, DocImage } from "/src/components/index.js"



测试前请验证待测试包MD5码和版本号与提测信息一致，以及是否能正常运行

## 测试准备

- 将待测试包体上传至 [爱加密平台](http://10.23.193.148:8080/detection-web/#/detection-manager/views/AssetOverview)

<DocImage src='ace/image-20220908154147402.png'></DocImage>

- 选择测试项并上传包体

<DocImage src='ace/image-20220908155013299.png'></DocImage>

- 点击确认上传

<DocImage src='ace/image-20220908160133498.png'></DocImage>

- 点击开始检测

<DocImage src='ace/image-20220908160237122.png'></DocImage>

- 勾选检测模板（备注：iOS勾选 - IOS默认通用检测模板）

<DocImage src='ace/image-20220908160345095.png'  ></DocImage>

- 等待检测完成后，查看检测报告

<DocImage src='ace/image-20220908160918378.png'></DocImage>

- 下载检测报告（最终测试报告中需将爱加密平台测试文档作为附件）

<DocImage src='ace/image-20220908160952066.png'></DocImage>

## Android测试流程

### 安全红线

安全红线未通过，游戏将无法上架

1. 测试项

- 对于平台检测项中与安全红线相关的检测项，需着重关注

| 安全红线 | 对应平台检测项                   |
| ----------------------------- | -------------------------------------- |
| AllowBackup备份权限配置安全性 | 数据越权备份风险检测                   |
| Debuggable调试权限配置安全性  | 敏感函数调用风险检测                   |
| janus安卓签名漏洞             | Janus签名机制漏洞                      |
| SDK安全检查                   | 第三方SDK检测                          |
| SDK安全检查 | “寄生推”SDK云控漏洞                    |
| 代码混淆                      | 代码未混淆风险检测                     |
| Activity组件安全              | Activity组件导出风险检测               |
| Broadcast组件安全             | Broadcast Receiver组件导出风险检测     |
| Content组件安全               | Content Provider组件导出风险检测       |
| Service组件安全               | Service组件导出风险检测                |
| Webview组件安全               | WebView远程调试风险检测                |
| Webview组件安全 | 未移除有风险的WebView系统隐藏接口漏洞  |
| Webview组件安全 | WebView跨域访问漏洞                    |
| Webview组件安全 | WebView File域同源策略绕过风险检测     |
| Webview组件安全 | WebView远程代码执行漏洞                |
| Webview组件安全 | WebView组件忽略SSL证书验证错误风险检测 |

2. 测试步骤

- 进入检测详情界面，风险漏洞页签，使用CTRL + F搜索上述平台检测项 

<DocImage src='ace/image-20220909102712517.png'></DocImage>

- 若检测结果为安全，则测试通过
- 若检测结果为存在风险，则需确认问题缘由，以及是否为不可修改问题
- 对于不能确认的问题请及时反馈项目组，并记录至  [安全历史问题](https://doc.weixin.qq.com/sheet/e3_AeIA0gYLACcH11t1izjQa2Ve0W4FV?scode=ANYAEAdoABE69XMbDWAeIA0gYLACc)

### 风险项

1. 进行[平台测试准备](#测试准备)

2. 测试结果筛选

- 将平台测试结果填入[安全平台检测项-Android](https://doc.weixin.qq.com/sheet/e3_AeIA0gYLACc6RCk4SEORhS0AbYNk2?scode=ANYAEAdoABEUQLwxnfAeIA0gYLACc)
- 复制当前测试结果，覆盖平台-检测项（汇总）页签中对应项目检测结果

<DocImage src='ace/image-20220908171941468.png'></DocImage>

<DocImage src='ace/image-20220908183858590.png'></DocImage>

- 填入平台结果后开启筛选

<DocImage src='ace/image-20220908172529030.png'></DocImage>

- 筛选出当前版本包体存在的问题

<DocImage src='ace/image-20220908172954332.png'></DocImage>

3. 测试结果分析

- 必须要修改的检查项，需均通过

<DocImage src='ace/image-20221012153139598.png'></DocImage>

- 对于所有未通过检查项均需进行分析，判断是否为不可修改问题（SDK设计如此，条件运行，[安全历史问题-平台检查项](https://doc.weixin.qq.com/sheet/e3_AeIA0gYLACcH11t1izjQa2Ve0W4FV?scode=ANYAEAdoABE69XMbDWAeIA0gYLACc)）

- 若不确定是否为不可修改问题，可反馈<WeChatLink name='v_taochenglong'>陶成龙</WeChatLink>

- 分析示例：数据库注入风险

<DocImage src='ace/image-20221012121218946.png'></DocImage>

- 数据库注入检查项存在问题，需要针对检查详情中的每一处进行检查分析，确认问题缘由


- 例如当前问题为在代码中发现query()函数使用了拼接字，并且定位的文件为g5.java


- 确认当前文件为项目组开发源码或SDK代码等，并反馈项目组


- 若无法确认，请联系<WeChatLink name='v_taochenglong'>陶成龙</WeChatLink>


- 分析完毕后，需将遇到的问题记录至  [安全历史问题](https://doc.weixin.qq.com/sheet/e3_AeIA0gYLACcH11t1izjQa2Ve0W4FV?scode=ANYAEAdoABE69XMbDWAeIA0gYLACc)

### 其他安全项

1. 权限**（重要、高危权限）**

[Google敏感信息访问权限](https://support.google.com/googleplay/android-developer/answer/9888170)

- QUERY_ALL_PACKAGES 权限：在AndroidManifest.xml中声明该权限将无法通过Google商店审核
- 打开AndroidManifest.xml文件（通过apktool解压缩，参考教程见 [加固测试](https://qaq.com/docs/services/safe/safeTest/process/加固测试)）
- ctrl + f  搜索QUERY_ALL_PACKAGES 权限，若存在测试不通过

<DocImage src='ace/image-20220908191609339.png'></DocImage>

- 平台权限信息扫描，查看是否存在高危权限

<DocImage src='ace/image-20220908191928254.png'></DocImage>

- 若存在，则测试不通过
